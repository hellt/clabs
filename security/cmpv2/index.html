<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Opensource catalog of containerlab based labs"><meta name=author content="Roman Dodin"><link rel=icon href=../../images/vial.svg><meta name=generator content="mkdocs-1.1.2, mkdocs-material-7.1.0"><title>Certificate management with CMPv2 - Lab catalog</title><link rel=stylesheet href=../../assets/stylesheets/main.33e2939f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ef6f36e2.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Manrope:300,400,400i,700%7CFira+Mono&display=fallback"><style>:root{--md-text-font-family:"Manrope";--md-code-font-family:"Fira Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-101537614-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script><!-- Determine title --><!-- The image needs to have an absolute URL --><!-- Open graph meta tags --><meta property=og:type content=website><meta property=og:title content="Lab catalog - Certificate management with CMPv2"><meta property=og:description content="Opensource catalog of containerlab based labs"><meta property=og:url content=None><meta property=og:image content=images/containerlab_black.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1092><meta property=og:image:height content=954><!-- Twitter meta tags --><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@ntdvps><meta name=twitter:creator content=@ntdvps><meta name=twitter:title content="Lab catalog - Certificate management with CMPv2"><meta name=twitter:description content="Opensource catalog of containerlab based labs"><meta name=twitter:image content=images/containerlab_black.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#certificate-management-in-an-operator-network class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Lab catalog" class="md-header__button md-logo" aria-label="Lab catalog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M477.7 186.1 309.5 18.3c-3.1-3.1-8.2-3.1-11.3 0l-34 33.9c-3.1 3.1-3.1 8.2 0 11.3l11.2 11.1L33 316.5c-38.8 38.7-45.1 102-9.4 143.5 20.6 24 49.5 36 78.4 35.9 26.4 0 52.8-10 72.9-30.1l246.3-245.7 11.2 11.1c3.1 3.1 8.2 3.1 11.3 0l34-33.9c3.1-3 3.1-8.1 0-11.2zM318 256H161l148-147.7 78.5 78.3L318 256z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Lab catalog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Certificate management with CMPv2 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=cyan type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hellt/clabs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hellt/clabs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../rs/bgp-vpls/ class=md-tabs__link> Routing & Switching </a> </li> <li class=md-tabs__item> <a href=../../telemetry/srl-telemetry/ class=md-tabs__link> Telemetry </a> </li> <li class=md-tabs__item> <a href=../../automation/comingsoon/ class=md-tabs__link> Automation </a> </li> <li class=md-tabs__item> <a href=../security/ class="md-tabs__link md-tabs__link--active"> Security </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Lab catalog" class="md-nav__button md-logo" aria-label="Lab catalog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M477.7 186.1 309.5 18.3c-3.1-3.1-8.2-3.1-11.3 0l-34 33.9c-3.1 3.1-3.1 8.2 0 11.3l11.2 11.1L33 316.5c-38.8 38.7-45.1 102-9.4 143.5 20.6 24 49.5 36 78.4 35.9 26.4 0 52.8-10 72.9-30.1l246.3-245.7 11.2 11.1c3.1 3.1 8.2 3.1 11.3 0l34-33.9c3.1-3 3.1-8.1 0-11.2zM318 256H161l148-147.7 78.5 78.3L318 256z"/></svg> </a> Lab catalog </label> <div class=md-nav__source> <a href=https://github.com/hellt/clabs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hellt/clabs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Routing & Switching <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Routing & Switching" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Routing & Switching </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../rs/bgp-vpls/ class=md-nav__link> BGP VPLS Deep dive </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Telemetry <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Telemetry data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Telemetry </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../telemetry/srl-telemetry/ class=md-nav__link> SR Linux streaming telemetry </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Automation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Automation data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../automation/comingsoon/ class=md-nav__link> coming soon </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5> Security <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Security data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../security/ class=md-nav__link> About </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Certificate management with CMPv2 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Certificate management with CMPv2 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#certificate-management-in-an-operator-network class=md-nav__link> Certificate management in an operator' network </a> </li> <li class=md-nav__item> <a href=#cmpv2 class=md-nav__link> CMPv2 </a> </li> <li class=md-nav__item> <a href=#deploying-a-lab class=md-nav__link> Deploying a lab </a> </li> <li class=md-nav__item> <a href=#ejbca-configuration class=md-nav__link> EJBCA Configuration </a> <nav class=md-nav aria-label="EJBCA Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cmp-alias class=md-nav__link> CMP Alias </a> </li> <li class=md-nav__item> <a href=#certificate-profile class=md-nav__link> Certificate Profile </a> </li> <li class=md-nav__item> <a href=#end-entity-profile class=md-nav__link> End Entity Profile </a> </li> <li class=md-nav__item> <a href=#end-entity class=md-nav__link> End Entity </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ca-certificate class=md-nav__link> CA certificate </a> </li> <li class=md-nav__item> <a href=#sr-os-configuration class=md-nav__link> SR OS Configuration </a> <nav class=md-nav aria-label="SR OS Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#keys-generation class=md-nav__link> Keys generation </a> </li> <li class=md-nav__item> <a href=#ca-certificate-import class=md-nav__link> CA certificate import </a> </li> <li class=md-nav__item> <a href=#ca-profile class=md-nav__link> CA profile </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cmpv2-protocol-operations class=md-nav__link> CMPv2 Protocol Operations </a> <nav class=md-nav aria-label="CMPv2 Protocol Operations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#initial-registration class=md-nav__link> Initial Registration </a> </li> <li class=md-nav__item> <a href=#configure-verify-secured-gnmi class=md-nav__link> Configure &amp; verify secured gNMI </a> </li> <li class=md-nav__item> <a href=#certificate-request class=md-nav__link> Certificate Request </a> </li> <li class=md-nav__item> <a href=#automated-certificate-renewal class=md-nav__link> Automated certificate renewal </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> Summary </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#certificate-management-in-an-operator-network class=md-nav__link> Certificate management in an operator' network </a> </li> <li class=md-nav__item> <a href=#cmpv2 class=md-nav__link> CMPv2 </a> </li> <li class=md-nav__item> <a href=#deploying-a-lab class=md-nav__link> Deploying a lab </a> </li> <li class=md-nav__item> <a href=#ejbca-configuration class=md-nav__link> EJBCA Configuration </a> <nav class=md-nav aria-label="EJBCA Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cmp-alias class=md-nav__link> CMP Alias </a> </li> <li class=md-nav__item> <a href=#certificate-profile class=md-nav__link> Certificate Profile </a> </li> <li class=md-nav__item> <a href=#end-entity-profile class=md-nav__link> End Entity Profile </a> </li> <li class=md-nav__item> <a href=#end-entity class=md-nav__link> End Entity </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ca-certificate class=md-nav__link> CA certificate </a> </li> <li class=md-nav__item> <a href=#sr-os-configuration class=md-nav__link> SR OS Configuration </a> <nav class=md-nav aria-label="SR OS Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#keys-generation class=md-nav__link> Keys generation </a> </li> <li class=md-nav__item> <a href=#ca-certificate-import class=md-nav__link> CA certificate import </a> </li> <li class=md-nav__item> <a href=#ca-profile class=md-nav__link> CA profile </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cmpv2-protocol-operations class=md-nav__link> CMPv2 Protocol Operations </a> <nav class=md-nav aria-label="CMPv2 Protocol Operations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#initial-registration class=md-nav__link> Initial Registration </a> </li> <li class=md-nav__item> <a href=#configure-verify-secured-gnmi class=md-nav__link> Configure &amp; verify secured gNMI </a> </li> <li class=md-nav__item> <a href=#certificate-request class=md-nav__link> Certificate Request </a> </li> <li class=md-nav__item> <a href=#automated-certificate-renewal class=md-nav__link> Automated certificate renewal </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> Summary </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Certificate management with CMPv2</h1> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td><strong>Description</strong></td> <td>Certificate Management with CMPv2</td> </tr> <tr> <td><strong>Components</strong></td> <td>Nokia SR OS, EJBCA</td> </tr> <tr> <td><strong>Resource requirements</strong><sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup></td> <td><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M416 48v416c0 26.51-21.49 48-48 48H144c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h224c26.51 0 48 21.49 48 48zm96 58v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42V88h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zm0 96v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42v-48h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zm0 96v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42v-48h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zm0 96v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42v-48h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zM30 376h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6zm0-96h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6zm0-96h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6zm0-96h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6z"/></svg></span> 2 <br><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><path d="M640 130.94V96c0-17.67-14.33-32-32-32H32C14.33 64 0 78.33 0 96v34.94c18.6 6.61 32 24.19 32 45.06s-13.4 38.45-32 45.06V320h640v-98.94c-18.6-6.61-32-24.19-32-45.06s13.4-38.45 32-45.06zM224 256h-64V128h64v128zm128 0h-64V128h64v128zm128 0h-64V128h64v128zM0 448h64v-26.67c0-8.84 7.16-16 16-16s16 7.16 16 16V448h128v-26.67c0-8.84 7.16-16 16-16s16 7.16 16 16V448h128v-26.67c0-8.84 7.16-16 16-16s16 7.16 16 16V448h128v-26.67c0-8.84 7.16-16 16-16s16 7.16 16 16V448h64v-96H0v96z"/></svg></span> 6 GB</td> </tr> <tr> <td><strong>Topology file</strong></td> <td><a href=https://github.com/hellt/clabs/blob/main/labs/cmpv2/cmp.clab.yml>cmp.clab.yml</a></td> </tr> <tr> <td><strong>Version information</strong><sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup></td> <td><code>containerlab:0.12.0</code>, <code>vr-sros:21.2.R1</code>, <code>docker-ce:19.03.13</code>, <code>vrnetlab:0.2.3</code><sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup></td> </tr> <tr> <td><strong>Authors</strong></td> <td>Colin Bookham, <a href=https://twitter.com/ntdvps>Roman Dodin</a></td> </tr> </tbody> </table> <p>Management protocols of the modern day and age must be secure, there is not disagreement in that. But adding security layers is not free, the costs of having a secured communication is spread across development, capex/opex, support and many other domains.</p> <p>Some state of the art management protocols like <a href=https://github.com/openconfig/reference/blob/master/rpc/gnmi/gnmi-specification.md>gNMI</a> do not even assume they can be used without a security layer on top<sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup>, which implies that its users will have to setup the necessary security infrastructure before gNMI can be used.</p> <details><summary>but what about unsecured gNMI?</summary><p>It is a networking vendor's hack that allowed users to start playing with gNMI without setting up PKI infra. While it is possible, the gNMI specification clearly states that "The session between the client and server MUST be encrypted using TLS...".</p> </details> <p>In case of gNMI, TLS protocol is used to secure the session between the client and the server. That inherently means:</p> <ul> <li>Certificate Authority (CA) must exist</li> <li>a set of keys and a certificate signing request (csr) must be created for a gNMI server (a router)</li> <li>CA has to sign this certificate</li> <li>A router needs to import this certificate and use it for gNMI protocol it runs</li> </ul> <p>As streaming telemetry and, consequently, gNMI are getting more popular, outgrowing the labs' simplified environments, operators are getting challenged with a question of <strong>how to enable certificate management for network devices at scale?</strong></p> <h2 id=certificate-management-in-an-operator-network>Certificate management in an operator' network<a class=headerlink href=#certificate-management-in-an-operator-network title="Permanent link">#</a></h2> <p>If you think that creating a CA and signing a few certificates is an easy thing to pull off with something like <code>openssl</code> or <code>certbot</code>, you might want to reconsider when a network of an operator is concerned.</p> <p>Network Operating Systems are not suitable to be used for something like <code>certbot</code>, as they won't be able to pass ACME challenge, nor DNS one. The manual certificate management with <code>openssl</code> can't stand a chance in a network with dozens and hundreds of nodes, this will get unmaintainable rather quickly.</p> <p>Ideally a workflow for maintaining certificates lifecycle in the operators network could look like this:</p> <ol> <li>CA maintains a registry of authenticated hosts for which it can enroll a certificate</li> <li>A node generates or obtains private/public keys</li> <li>A node contacts CA, authenticates and asks to issue/sign the certificate for it</li> <li>The signed certificate is transferred from CA to the node over the same channel</li> <li>Node installs that certificate</li> <li>Before the certificate is about to expire, the node reaches to CA and asks it to issue a new certificate that the node uses instead of the one that is expiring</li> </ol> <h2 id=cmpv2>CMPv2<a class=headerlink href=#cmpv2 title="Permanent link">#</a></h2> <p>Luckily, a few protocols exist to adhere to a workflow like that, and in this tutorial we will focus on one of them - CMPv2<sup id=fnref:5><a class=footnote-ref href=#fn:5>5</a></sup>.</p> <p>CMPv2 is extensively used in mobile networks to manage certificates between the infrastructure nodes and it is also implemented by most networking vendors.</p> <p>Without going into much details it is sufficient to say, that CMPv2 follows the workflow outlined above and this lab will demonstrate how Nokia SR OS router can initiate a certificate enrollment process and update it when needed.</p> <p>To make use of CMPv2 we need to have a CA that supports that protocol. This lab uses EJBCA server from primekey via their official <a href=https://hub.docker.com/r/primekey/ejbca-ce>docker image</a>.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>The purpose of this lab is to provide a complete environment to demonstrate how CMPv2 can be used to manage certificates in an operator' network.</p> </div> <h2 id=deploying-a-lab>Deploying a lab<a class=headerlink href=#deploying-a-lab title="Permanent link">#</a></h2> <p>As usual with containerlab labs any deployment is a one-click task. Copy this lab' <a href=https://github.com/hellt/clabs/blob/main/labs/cmpv2/cmp.clab.yml>clab file</a>, ensure that you have <code>_license.txt</code> file for SR OS node available in your current working directory and deploy.</p> <div class=highlight><pre><span></span><code>‚ùØ clab dep -t cmp.clab.yml
INFO[0000] Parsing &amp; checking topology file: cmp.clab.yml 
INFO[0000] Creating lab directory: /root/clabs/labs/cmpv2/clab-cmp 
INFO[0000] Creating container: ejbca                    
INFO[0000] Creating container: sr                       
INFO[0001] Writing /etc/hosts file                      
+---+----------------+--------------+--------------------------+---------+-------+---------+----------------+----------------------+
| # |      Name      | Container ID |          Image           |  Kind   | Group |  State  |  IPv4 Address  |     IPv6 Address     |
+---+----------------+--------------+--------------------------+---------+-------+---------+----------------+----------------------+
| 1 | clab-cmp-ejbca | 14f21198f5a7 | primekey/ejbca-ce        | linux   |       | running | 172.20.20.6/24 | 2001:172:20:20::6/80 |
| 2 | clab-cmp-sr    | 8e3123c84b3a | vrnetlab/vr-sros:21.2.R1 | vr-sros |       | running | 172.20.20.5/24 | 2001:172:20:20::5/80 |
+---+----------------+--------------+--------------------------+---------+-------+---------+----------------+----------------------+
</code></pre></div> <details><summary>Persistent EJBCA</summary><p>The clab file configuration for EJBCA assumes that no persistency is needed across lab runs. When the lab is destroyed, EJBCA config are removed as well. If EJBCA persistency is desired, users need to create a directory on their container host and mount it in the clab file like that:<br> <div class=highlight><pre><span></span><code><span class=nt>binds</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/home/ejbca:/mnt/persistent</span>
</code></pre></div> This will save the EJBCA database under the <code>/home/ejbca</code> dir on the container host</p> </details> <p>When the lab starts, the EJBCA enters its initialization routine. You can monitor the progress with <code>docker logs -f clab-cmp-ejbca</code>. Once finished, the EJBCA web server will be available via <code>8443</code> port.</p> <h2 id=ejbca-configuration>EJBCA Configuration<a class=headerlink href=#ejbca-configuration title="Permanent link">#</a></h2> <p>EJBCA exposes web interface for its configuration. To access the main admin panel we use HTTPS connection over 8443 port - <code>https://localhost:8443/ejbca/adminweb/</code> - which is exposed by containerlab to 8443 port of the container host.</p> <p><img alt=admin src=https://gitlab.com/rdodin/pics/-/wikis/uploads/afe7c909f9d3087a2393428235442683/image.png></p> <h3 id=cmp-alias>CMP Alias<a class=headerlink href=#cmp-alias title="Permanent link">#</a></h3> <p>From the EJBCA perspective the CMP protocol configuration is done with creating a "CMP Alias".</p> <p>On the EJBCA Administration home page, select CMP Configuration in the left hand pane (under System Configuration) and add a CMP Alias; in our case named "CMP-Server".</p> <p>Once it is added, select edit, and then in the CMP Authentication Module ensure that "DnPartPwd" is selected and that the Subject DN Part is CN. This is used to extract the username of the node from its CN field when the node reaches out to CA and asks to enroll its certificate.</p> <p><img alt=CMP src=https://gitlab.com/rdodin/pics/-/wikis/uploads/cbfbd86e8774accdb50e69321053947b/image.png></p> <p>Select Save at the bottom of the window to commit the CMP configuration.</p> <h3 id=certificate-profile>Certificate Profile<a class=headerlink href=#certificate-profile title="Permanent link">#</a></h3> <p>The Certificate Profile is a one-off configuration requirement.<br> By default, the EJBCA server uses a certificate profile called <code>ENDUSER</code>. This profile sets X.509v3 extensions for Key Usage and Extended Key Usage to TLS Client authentication and Email Protection only.</p> <p><img alt=certprof src=https://gitlab.com/rdodin/pics/-/wikis/uploads/5d4b0058d70beb73cc758dbee65474e1/image.png></p> <p>Since we want to use the certificate for gNMI (TLS Server) and the default <code>ENDUSER</code> profile cannot be edited, we need to create a new certificate profile disabling these extensions.</p> <p>From the EJBCA Administration home page, select Certificate Profiles under CA Functions, and add a new entry. The below output shows the creation of a certificate profile called END-ENTITY, which removes all X509v3 extensions with the exception of Subject Alternative Name.</p> <p><img alt=newcertprof src=https://gitlab.com/rdodin/pics/-/wikis/uploads/27484b3a14c9a7d1a0e58254622eeaa7/image.png></p> <h3 id=end-entity-profile>End Entity Profile<a class=headerlink href=#end-entity-profile title="Permanent link">#</a></h3> <p>The End Entity Profile is a one-off configuration requirement.</p> <p>To allow End Entities to use the newly-created Certificate Profile, we need to create an End Entity profile to reference it.</p> <p>From the EJBCA Administration home page, select End Entity Profiles under RA Functions. Add a new profile, in our case <code>EE-PROFILE</code>, and edit the following:</p> <ul> <li>In the subject DN Attributes pane, use the Subject DN Attributes drop-down menu to add the required parts of the DN. In this case we add Country, State, and Organisation in addition to the existing Common Name. Tick all of them as required.</li> <li>In the Other Subject Attributes pane, use the Subject Alternative Name drop-down menu to add IP Address. Again, tick as required.</li> <li>In the "Main Certificate Data" pane use the drop-down menu for Default Certificate Profile to select the END-ENTITY certificate profile. In the Other subject attributes pain select IP Address as the Subject Alternative Name. Select Save at the bottom of the screen.</li> </ul> <p><img alt=eeprofile src=https://gitlab.com/rdodin/pics/-/wikis/uploads/dca50bb1d0d4dca05c3102e7cbaf53d6/image.png></p> <p>There is no requirement to enter the Password (or Enrolment Code) in the End Entity Profile. This differs on a per End Entity basis and will therefore be entered at that level.</p> <h3 id=end-entity>End Entity<a class=headerlink href=#end-entity title="Permanent link">#</a></h3> <p>End Entity configuration is required for each and every router that will be issued with an X.509 certificate.</p> <p>From the EJBCA Administration home page, select "Add End Entity" in the left hand pane under RA Functions.</p> <ul> <li>In the End Entity Profile field select the previously created <code>EE-PROFILE</code></li> <li>The password or enrolment code should be the same value as the CN entered in the Subject DN Attributes section and also in the CMP <a href>Initial-Registration</a> request subsequently sourced by the SR-OS node.</li> <li>Complete the subject DN attributes. This example uses Country (C), State (ST), Organisation (O), and Common Name (CN). Again, the same values will be used in the CMP Initial-Registration request subsequently sourced by the SR-OS node. </li> <li>Add the IP address as the subject alternative name so that the issued certificate will also be valid for node's IP address. In our case we will use the management IP address that containerlab assigned for us (172.20.20.5)</li> <li>Select the previously configured END-ENTITY profile as the certificate profile.</li> </ul> <p><img alt=ee src=https://gitlab.com/rdodin/pics/-/wikis/uploads/db0147521ab56614b99717986ffd140f/image.png></p> <p>When all fields have been completed, select Add at the bottom of the screen. This completes EJBCA configuration.</p> <h2 id=ca-certificate>CA certificate<a class=headerlink href=#ca-certificate title="Permanent link">#</a></h2> <p>To let our SR OS node to verify the certificate chain and be able to use CMPv2 protocol with the EJBCA, we need to transfer the CA certificate to it.</p> <p>CA certificate of the EJBCA server can be downloaded from the Registration Authority server that runs on EJBCA node.</p> <p>From the EJBCA Administration homepage, in the left hand pane select RA Web, which opens up another "EJBCA's RA GUI" tab. From here select "CA Certificates and CRLs" from the options along the top of the screen, and then download the Management CA Certificate in PEM format simply by selecting the appropriate link.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>Management CA certificate can also be downloaded from the headless VM using lynx or any other text-based browser.</p> </div> <p>Next copy over this certificate to the SR OS node:</p> <div class=highlight><pre><span></span><code>scp ManagementCA.pem admin@clab-cmp-sr:cf3:/
Warning: Permanently added &#39;clab-cmp-sr,172.20.20.5&#39; (RSA) to the list of known hosts.

admin@clab-cmp-sr&#39;s password:
ManagementCA.pem                                     100% 1848    18.7KB/s   00:00
</code></pre></div> <p>We will import this certificate into SR OS at a later stage.</p> <h2 id=sr-os-configuration>SR OS Configuration<a class=headerlink href=#sr-os-configuration title="Permanent link">#</a></h2> <h3 id=keys-generation>Keys generation<a class=headerlink href=#keys-generation title="Permanent link">#</a></h3> <p>To create a router's certificate we first need to have a private/public key pair. Many NOS'es allow to generate the keys "on-box", and that is what we will use here:</p> <div class=highlight><pre><span></span><code>//admin certificate gen-keypair cf3:/sr-key size 2048 type rsa
</code></pre></div> <p>The generation process create the keys, but they are not imported yet. To import the keys issue:</p> <div class=highlight><pre><span></span><code>//admin certificate import type key input cf3:/sr-key output sr-key format der
</code></pre></div> <h3 id=ca-certificate-import>CA certificate import<a class=headerlink href=#ca-certificate-import title="Permanent link">#</a></h3> <p>Next step is to import the ManagementCA certificate of EJBCA. We copied it over a few steps before, now let's import it:</p> <div class=highlight><pre><span></span><code>//admin certificate import type cert input cf3:/ManagementCA.pem output ManagementCA.pem format pem
</code></pre></div> <p>When certificate/keys get imported, the artifacts are copied over to a system directory named <code>system-pki</code>. As a result of a previous import, there will be a key file present with a name <code>sr-key</code>.</p> <p>The imported certificated can be displayed to ensure that it is the one that is needed:</p> <div class=highlight><pre><span></span><code>//admin certificate display type cert format der cf3:/system-pki/ManagementCA.pem
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            22:41:be:6b:87:94:a6:34:06:ce:73:63:01:6e:e5:80:d2:34:2d:5c
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: UID=c-0gkhtv71ootnm60rn, CN=ManagementCA, O=EJBCA Container Quickstart
&lt;SNIPPED&gt;
</code></pre></div> <h3 id=ca-profile>CA profile<a class=headerlink href=#ca-profile title="Permanent link">#</a></h3> <p>Now it is time to touch PKI related configuration on SR OS. We start by configuring CA Profile which defines the Certificate Authority for our SR OS node. This profile will hold the CMPv2 configuration</p> <div class=highlight><pre><span></span><code>edit-config private

<span class=c1># enable profile</span>
/configure system security pki ca-profile <span class=s2>&quot;ejbca-profile&quot;</span> admin-state <span class=nb>enable</span>

<span class=c1># refer to the CA cert file we imported before</span>
/configure system security pki ca-profile ejbca-profile cert-file ManagementCA.pem

<span class=c1># allow unprotected messages</span>
/configure system security pki ca-profile ejbca-profile cmpv2 accept-unprotected-message error-message
/configure system security pki ca-profile ejbca-profile cmpv2 accept-unprotected-message pkiconf-message

<span class=c1># specify sender info during cmpv2 initial registration message</span>
/configure system security pki ca-profile ejbca-profile cmpv2 always-set-sender-for-ir

<span class=c1># skip CRL check</span>
/configure system security pki ca-profile <span class=s2>&quot;ejbca-profile&quot;</span> revocation-check crl-optional

<span class=c1># set URL of CMPv2 server</span>
/configure system security pki ca-profile ejbca-profile cmpv2 url url-string http://172.20.20.6:8080/ejbca/publicweb/cmp/CMP-Server

<span class=c1># add CMPv2 authentication data</span>
/configure system security pki ca-profile <span class=s2>&quot;ejbca-profile&quot;</span> cmpv2 key-list key <span class=m>1</span> password sr

commit
</code></pre></div> <p>Let's talk about the last two for a moment. There we first say how to reach CMPv2 server, and to get its address, we use the management address that containerlab assigned to EJBCA node (172.20.20.6 in our case), then goes the static URL until the last element where we specify the CMP Alias <a href=#cmp-alias>created earlier</a> on EJBCA. Our CMP Alias was <code>CMP-Server</code>, thus it is appeared in the URL for EJBCA server.</p> <p>Then we create a key-list that holds a password that should match the enrollment code that we used during <a href=#end-entity>End Entity creation</a>. We used <code>sr</code> as the password string, thus we are referencing it in plain text as <code>key 1</code>.</p> <p>To verify the operation status of the CA Profile:</p> <div class=highlight><pre><span></span><code>A:admin@sr# /show certificate ca-profile &quot;ejbca-profile&quot;

===============================================================================
PKI CA-Profile Information
===============================================================================
CA Profile     : ejbca-profile                  Admin State    : up
Description    : (Not Specified)
CRL File       : (Not Specified)
Cert File      : ManagementCA.pem
Oper State     : up
Oper Flags     : &lt;none&gt;
Revoke Chk     : crl-optional

CMPv2
-------------------------------------------------------------------------------
HTTP Timeout   : 30 secs                        Router         : Base
CA URL         : http://172.20.20.6:8080/ejbca/publicweb/cmp/CMP-Server
Sign Cert URL  : (Not Specified)
Unprot Err Msg : enabled                        Unprot Pki Conf: enabled
Same RecipNonce: disabled
for Poll-reqs
Set Sndr for IR: True
HTTP version   : 1.1
</code></pre></div> <details><summary>Check SR OS &lt;-&gt; EJBCA connectivity</summary><p>If something doesn't work, check if your router can reach EJBCA. In our case, EJBCA management IP is 172.20.20.6, so we can check if it's reachable from SR OS:<br> <div class=highlight><pre><span></span><code>(pr)[/]
A:admin@sr# ping 172.20.20.6 router-instance &quot;management&quot;
PING 172.20.20.6 56 data bytes
64 bytes from 172.20.20.6: icmp_seq=1 ttl=63 time=0.668ms.
</code></pre></div></p> </details> <h2 id=cmpv2-protocol-operations>CMPv2 Protocol Operations<a class=headerlink href=#cmpv2-protocol-operations title="Permanent link">#</a></h2> <h3 id=initial-registration>Initial Registration<a class=headerlink href=#initial-registration title="Permanent link">#</a></h3> <p>Protocol wise everything starts with Initial Registration message that End Entity (SR OS router) node sends towards CMP server (EJBCA).</p> <p>Use the following <code>admin certificate</code> command to send the CMPv2 initial-registration message and receive a signed certificate from the CA. The protection-algorithm in use is <code>password</code>, and the actual password should be equivalent to the value of CN as configured in the <a href=#end-entity>EJBCA End Entity Configuration</a>, as should the values entered in the subject-dn.</p> <div class=highlight><pre><span></span><code>//admin certificate cmpv2 initial-registration ca &quot;ejbca-profile&quot; key-to-certify sr-key protection-alg password sr reference 1 subject-dn C=NL,ST=ZH,O=Nokia,CN=sr ip-addr 172.20.20.5 save-as cf3:/sr-cert.der

Processing request...
Received &#39;accepted&#39;.
</code></pre></div> <p>With this command we made SR OS node to contact CMPv2 Server running on EJBCA and requesting it to enroll a certificate for it. Since EJBCA had an End Entity configured with matched Subject DN fields and plain text password authentication, the request succeeded, and SR OS got its signed certificate. The certificate will be valid for IP SAN <code>172.20.20.5</code>.</p> <p>The request that SR OS sent can be viewed with the following command:</p> <div class=highlight><pre><span></span><code>//admin certificate cmpv2 show-request ca &quot;ejbca-profile&quot;

===============================================================================
CMPv2 Request
===============================================================================
CA Profile          : ejbca-profile
Original Request    : initialRegistration
Request Start Time  : 2021/03/30 19:24:40
Message Protection  : password-based
Reference number    : 1
Subject DN          : C=NL,ST=ZH,O=Nokia,CN=sr
Subject Alt. Name
    Domain Name     : (Not Specified)
    IP Address      : (Not Specified)
Key to Certify      : sr-key
Save-as file path   : cf3:\sr-cert.der
Request Status      : processed
CA Response         : accepted
CA Reply Time       : 2021/03/30 19:24:41
Additional Info     : (Not Specified)
===============================================================================
</code></pre></div> <p>To display the freshly minted certificate:</p> <div class=highlight><pre><span></span><code>//admin certificate display type cert format der cf3:/sr-cert.der

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            08:92:70:57:1e:d6:f7:93:5f:1a:26:d4:9e:cf:be:66:88:07:80:07
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: UID=c-0gkhtv71ootnm60rn, CN=ManagementCA, O=EJBCA Container Quickstart
        Validity
            Not Before: Mar 30 19:24:28 2021 GMT
            Not After : Mar 30 19:24:28 2023 GMT
        Subject: CN=sr, O=Nokia, ST=ZH, C=NL
        &lt;SNIP&gt;
        X509v3 extensions:
            X509v3 Subject Alternative Name:
                IP Address:172.20.20.6
</code></pre></div> <p>As the above output shows, the received certificate is indeed signed by EJBCA and is enrolled for our SR OS node, valid for both Subject-DN and node's IP Address.</p> <div class="admonition info"> <p class=admonition-title><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 16v2h-2c-1.4 0-2.8-.4-4-1-2.5 1.3-5.5 1.3-8 0-1.2.6-2.6 1-4 1H2v-2h2c1.4 0 2.8-.5 4-1.3 2.4 1.7 5.6 1.7 8 0 1.2.8 2.6 1.3 4 1.3h2M5.28 13.79c.54-.16 1.09-.41 1.61-.75l1.14-.77 1.13.8C10 13.66 11 14 12 14c1 0 2-.34 2.84-.93l1.13-.8 1.14.77c.82.55 1.72.86 2.56.93C18.24 7.4 12.37 2 6 2c-.35 0-.67.18-.85.47-.18.3-.2.67-.04.98 2.17 4.34 1.5 7.84.17 10.34M16 18.7c-2.4 1.7-5.6 1.7-8 0-1.2.8-2.6 1.3-4 1.3H2v2h2c1.4 0 2.8-.4 4-1 2.5 1.3 5.5 1.3 8 0 1.2.6 2.6 1 4 1h2v-2h-2c-1.4 0-2.8-.5-4-1.3z"/></svg></span> packet capture</p> <p><a href=https://gitlab.com/rdodin/pics/-/wikis/uploads/85e2c84bc7a9672fc2f186ed14c1d89d/Initial-Registration.pcapng>This pcap</a> captures the message exchange during the initial-registration request, consisting of initialisation request (ir), initialisation response (ip), certificate confirmation, and PKI confirmation</p> </div> <p>Once the certificate has been passed by the CA, it needs to be imported so that it can be used for PKI purposes. Note that because the input file is in DER format, the output file is also in DER format. Outputting to a different format will result in a failed import.</p> <div class=highlight><pre><span></span><code>//admin certificate import type cert input cf3:/sr-cert.der output sr-cert format der
</code></pre></div> <h3 id=configure-verify-secured-gnmi>Configure &amp; verify secured gNMI<a class=headerlink href=#configure-verify-secured-gnmi title="Permanent link">#</a></h3> <p>To test that the issued certificate is good to be used for secured gNMI we need to create another SR OS constructs - Certificate Profile and TLS Server Profile.</p> <p>Readers can refer to <a href=https://containerlab.srlinux.dev/lab-examples/tls-cert/ >"Securing gNMI with TLS"</a> lab which goes into details of this, here we will just repeat the needed commands:</p> <div class=highlight><pre><span></span><code><span class=c1># configure certificate profile</span>
/configure system security tls cert-profile sr-cert-prof entry <span class=m>1</span> certificate-file sr-cert
/configure system security tls cert-profile sr-cert-prof entry <span class=m>1</span> key-file sr-key
/configure system security tls cert-profile sr-cert-prof admin-state <span class=nb>enable</span>

<span class=c1># ciphers list</span>
/configure system security tls server-cipher-list <span class=s2>&quot;ciphers&quot;</span> cipher <span class=m>1</span> name tls-rsa-with3des-ede-cbc-sha
/configure system security tls server-cipher-list <span class=s2>&quot;ciphers&quot;</span> cipher <span class=m>2</span> name tls-rsa-with-aes128-cbc-sha256

<span class=c1># configure server profile</span>
/configure system security tls server-tls-profile sr-server-tls-prof cert-profile <span class=s2>&quot;sr-cert-prof&quot;</span> admin-state <span class=nb>enable</span>
/configure system security tls server-tls-profile sr-server-tls-prof cert-profile <span class=s2>&quot;sr-cert-prof&quot;</span> cipher-list <span class=s2>&quot;ciphers&quot;</span>

<span class=c1># make gNMI to use tls profile</span>
/configure system grpc tls-server-profile <span class=s2>&quot;sr-server-tls-prof&quot;</span>
commit
</code></pre></div> <p>Now when gNMI is configured to use the TLS security, we can verify that it all works by using <a href=https://gnmic.kmrd.dev>gnmic</a> client with specifying the EJBCA CA file for verification.</p> <div class=highlight><pre><span></span><code><span class=c1># using Mgmt IP address of the node</span>
gnmic -a <span class=m>172</span>.20.20.5 -u admin -p admin  --tls-ca /root/clabs/labs/cmpv2/ManagementCA.pem capabilities
gNMI version: <span class=m>0</span>.7.0
supported models:
  - nokia-conf, Nokia, <span class=m>21</span>.2.R1
  - nokia-state, Nokia, <span class=m>21</span>.2.R1
  - nokia-li-state, Nokia, <span class=m>21</span>.2.R1
  - nokia-li-conf, Nokia, <span class=m>21</span>.2.R1
supported encodings:
  - JSON
  - BYTES
  - PROTO
</code></pre></div> <p>At this stage, we demonstrated how a network node can successfully enroll its certificate that can be used to secure the gNMI communication channel. What we haven't covered yet is the way to manage the certificate lifecycle. That is the goal of the subsequent sections.</p> <h3 id=certificate-request>Certificate Request<a class=headerlink href=#certificate-request title="Permanent link">#</a></h3> <p>A Certificate Request message is used to obtain a new certificate after the End Entity has obtained the initial certificate from the CA. The message flow is similar to that of the Initial Request and consists of the Certificate Request (cr) and Certificate Response (cp), followed by the Certificate Confirmation and PKI Confirmation.</p> <p>When making the Certificate-Request for a new certificate a requirement is to generate and load the new certificate without having to make any configuration changes to the TLS configuration. At present, the SR OS TLS cert-profile references a certificate with the name of "sr-cert" and a key-pair with the name of "sr-key".</p> <div class=highlight><pre><span></span><code>(pr)[/configure system security tls cert-profile &quot;sr-cert-prof&quot;]
A:admin@sr# info
    admin-state enable
    entry 1 {
        certificate-file &quot;sr-cert&quot;
        key-file &quot;sr-key&quot;
    }
</code></pre></div> <p>The certificate request requires generation of a new keypair. Note that when the key is output to the <code>system-pki</code> directory the same filename is used as that already referenced in the TLS cert-profile.</p> <div class=highlight><pre><span></span><code>//admin certificate gen-keypair cf3:/sr-key size 2048 type rsa
//admin certificate import type key input cf3:/sr-key output sr-key format der
</code></pre></div> <p>The syntax of the Certificate Request from the router is similar to that of the Initial Request, with the notable exception that no password protection is required as the digital signature from the previously issued certificate is used as a form of authentication. The command calls the old keypair as well as the newly-generated keypair, but in this case they refer to the same filename.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>To make a certificate request to the EJBCA server before a certificate has expired, search the relevant End Entity and change the Status of that End Entity from "Generated" to "New".<br> As well as delete the existing certificate file from SR OS compact flash: <code>file remove cf3:/sr-cert.der</code> before requesting a new certificate.</p> </div> <div class=highlight><pre><span></span><code>//admin certificate cmpv2 cert-request ca &quot;ejbca-profile&quot; current-key sr-key current-cert sr-cert newkey sr-key subject-dn C=NL,ST=ZH,O=Nokia,CN=sr ip-addr 172.20.20.5 save-as cf3:/sr-cert.der
Processing request...
Received &#39;accepted&#39;.
</code></pre></div> <p>The "accepted" indication means that the certificate was successfully issued by the CA. This can also be verified with the following command.</p> <div class=highlight><pre><span></span><code>//admin certificate cmpv2 show-request ca &quot;ejbca-profile&quot;

===============================================================================
CMPv2 Request
===============================================================================
CA Profile          : ejbca-profile
Original Request    : certRequest
Request Start Time  : 2021/03/31 07:15:20
Message Protection  : signature-based
Current Certificate : sr-cert
Hash Algorithm      : sha1
Subject DN          : C=NL,ST=ZH,O=Nokia,CN=sr
Subject Alt. Name
    Domain Name     : (Not Specified)
    IP Address      : 172.20.20.5
Current Key         : sr-key
New Key             : sr-key
Save-as file path   : cf3:\sr-cert.der
Request Status      : processed
CA Response         : accepted
CA Reply Time       : 2021/03/31 07:15:20
Additional Info     : (Not Specified)
===============================================================================
</code></pre></div> <div class="admonition info"> <p class=admonition-title><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 16v2h-2c-1.4 0-2.8-.4-4-1-2.5 1.3-5.5 1.3-8 0-1.2.6-2.6 1-4 1H2v-2h2c1.4 0 2.8-.5 4-1.3 2.4 1.7 5.6 1.7 8 0 1.2.8 2.6 1.3 4 1.3h2M5.28 13.79c.54-.16 1.09-.41 1.61-.75l1.14-.77 1.13.8C10 13.66 11 14 12 14c1 0 2-.34 2.84-.93l1.13-.8 1.14.77c.82.55 1.72.86 2.56.93C18.24 7.4 12.37 2 6 2c-.35 0-.67.18-.85.47-.18.3-.2.67-.04.98 2.17 4.34 1.5 7.84.17 10.34M16 18.7c-2.4 1.7-5.6 1.7-8 0-1.2.8-2.6 1.3-4 1.3H2v2h2c1.4 0 2.8-.4 4-1 2.5 1.3 5.5 1.3 8 0 1.2.6 2.6 1 4 1h2v-2h-2c-1.4 0-2.8-.5-4-1.3z"/></svg></span> packet capture</p> <p><a href=https://gitlab.com/rdodin/pics/-/wikis/uploads/0c37a4dd9b2a0023cee57782f6a5260c/Certificate-Request.pcapng>This pcap</a> captures the message exchange during the Certificate Request procedure.</p> </div> <p>It is thereafter necessary to import the received certificate into the <code>system-pki</code> directory for use.</p> <div class=highlight><pre><span></span><code>//admin certificate import type cert input cf3:/sr-cert.der output sr-cert format der
</code></pre></div> <p>Finally, it is necessary to do a reload of the certificate and keypair to ensure that the new keypair and certificate are loaded into memory.</p> <div class=highlight><pre><span></span><code>//admin certificate reload type cert-key-pair sr-cert protocol tls key-file sr-key
</code></pre></div> <p>The reload status can be seen in log 101:</p> <div class=highlight><pre><span></span><code>A:admin@sr# /show log log-id 101

===============================================================================
Event Log 101 log-name 101
===============================================================================
Description : Default NETCONF event stream
Log contents  [size=500   next event=249  (not wrapped)]

248 2021/03/31 07:21:20.403 UTC MINOR: SECURITY #2101 Base TLS
&quot;Certificate file &quot;sr-cert&quot; has been reloaded.&quot;

247 2021/03/31 07:21:20.403 UTC MINOR: SECURITY #2101 Base TLS
&quot;Key file &quot;sr-key&quot; has been reloaded.&quot;
</code></pre></div> <p>Now we can again check that gNMI client can successfully call the RPCs over a secure channel with a new node certificates in place.</p> <h3 id=automated-certificate-renewal>Automated certificate renewal<a class=headerlink href=#automated-certificate-renewal title="Permanent link">#</a></h3> <p>As demonstrated above, Certificate Request message can be used to re-issue a new certificate. Let's close the loop here and create an automated renewal routine that will result in a router to request a new certificate by the time a current one is about to expire.</p> <p>The SR OS PKI configuration provides an option for generating expiration warnings when a certificate and/or CRL is about to expire. On our node we configured the certificate expiration warning to be 6 hours, with a repeat warning every subsequent hour:</p> <div class=highlight><pre><span></span><code>/configure system security pki certificate-expiration-warning hours 6 repeat-hours 1
</code></pre></div> <p>The corresponding log event looks like the following:</p> <div class=highlight><pre><span></span><code>*A:pe-1# show log log-id 90

===============================================================================
Event Log 90
===============================================================================
Description : (Not Specified)
Memory Log contents  [size=100   next event=114  (wrapped)]

113 2021/03/15 15:47:51.997 GMT MINOR: SECURITY #2095 Base Cert
&quot;Certificate pe1-cert used by TLS will expire in 5 hour(s) and 0 minute(s).&quot;

110 2021/03/15 14:47:51.997 GMT MINOR: SECURITY #2095 Base Cert
&quot;Certificate pe1-cert used by TLS will expire in 6 hour(s) and 0 minute(s).&quot;
</code></pre></div> <p>The system is configured to use the Event Handling System such that when the certificate expiration alarm is generated with an hour to go, that the system will request and install a new certificate. A key role in this procedure plays a script that is executed when a certain message appears in the log.</p> <div class=highlight><pre><span></span><code>//file show auto-cert-update.txt
File: auto-cert-update.txt
-------------------------------------------------------------------------------
exit all
file remove cf3:/sr-cert.der force
sleep 2
//admin certificate gen-keypair cf3:/sr-key size 2048 type rsa
sleep 5
//admin certificate import type key input cf3:/sr-key output sr-key format der
sleep 5
//admin certificate cmpv2 cert-request ca &quot;ejbca-profile&quot; current-key sr-key current-cert sr-cert newkey sr-key subject-dn C=NL,ST=ZH,O=Nokia,CN=sr ip-addr 172.20.20.5 save-as cf3:/sr-cert.der
sleep 10
//admin certificate import type cert input cf3:/sr-cert.der output sr-cert format der
sleep 5
//admin certificate reload type cert-key-pair sr-cert protocol tls key-file sr-key
exit all
</code></pre></div> <p>Essentially this script just repeats the steps we did manually before.</p> <p>The following snipped shows configuration steps required to configure EHS subsystem of SR OS to call the script when the certificate only has 1 hour left before expiry:</p> <div class=highlight><pre><span></span><code><span class=c1># create script control policy</span>
/configure system script-control script <span class=s2>&quot;auto-cert-update&quot;</span> location cf3:/auto-cert-update.txt admin-state <span class=nb>enable</span>
/configure system script-control script-policy <span class=s2>&quot;auto-cert-update&quot;</span> results <span class=s2>&quot;cf3:/cert-update-results.txt&quot;</span> admin-state <span class=nb>enable</span>
/configure system script-control script-policy <span class=s2>&quot;auto-cert-update&quot;</span> script name <span class=s2>&quot;auto-cert-update&quot;</span>

<span class=c1># configure log filter to match on a message about cert expiration</span>
/configure log filter <span class=m>100</span> default-action drop
/configure log filter <span class=m>100</span> named-entry cert-update action forward
/configure log filter <span class=m>100</span> named-entry cert-update match message eq  <span class=s2>&quot;Certificate sr-cert used by TLS will expire in 1 hour(s) and 0 minute(s)&quot;</span>

<span class=c1># create event handler that will call a previously created script</span>
/configure log event-handling handler <span class=s2>&quot;auto-cert-update&quot;</span> entry <span class=m>1</span> script-policy name <span class=s2>&quot;auto-cert-update&quot;</span>
/configure log event-handling handler <span class=s2>&quot;auto-cert-update&quot;</span> admin-state <span class=nb>enable</span>

<span class=c1># configure event trigger to match on log filter rule and call the handler</span>
/configure log event-trigger security event tmnxPkiCertBeforeExpWarning entry <span class=m>1</span> handler <span class=s2>&quot;auto-cert-update&quot;</span> admin-state <span class=nb>enable</span>
/configure log event-trigger security event tmnxPkiCertBeforeExpWarning entry <span class=m>1</span> filter <span class=s2>&quot;100&quot;</span>
/configure log event-trigger security event tmnxPkiCertBeforeExpWarning admin-state <span class=nb>enable</span>
</code></pre></div> <p>After the certificate has expired there are various places which can be used to confirm the EHS script was successful. Firstly, a check of log 99, which shows that the SROS CLI file cf3:/auto-cert-update was completed successfully.</p> <div class=highlight><pre><span></span><code>*A:pe-1# show log log-id 99

===============================================================================
Event Log 99
===============================================================================
Description : Default System Log
Memory Log contents  [size=500   next event=3223  (wrapped)]

3222 2021/03/16 03:30:58.138 GMT MAJOR: SYSTEM #2053 Base CLI &#39;exec&#39;
&quot;The CLI user initiated &#39;exec&#39; operation to process the commands in the SROS CLI file cf3:/auto-cert-update.txt has completed with the result of success&quot;

3221 2021/03/16 03:30:26.001 GMT MAJOR: SYSTEM #2052 Base CLI &#39;exec&#39;
&quot;A CLI user has initiated an &#39;exec&#39; operation to process the commands in the SROS CLI file cf3:/auto-cert-update.txt&quot;

3220 2021/03/16 03:30:25.997 GMT MINOR: SYSTEM #2069 Base EHS script
&quot;Ehs handler :&quot;auto-cert-update&quot; with the description : &quot;&quot; was invoked by the cli-user account &quot;not-specified&quot;.&quot;
</code></pre></div> <p>Finally, a users can check of the event-handling handler "auto-cert-update" shows a success, and the last time the script was executed.</p> <div class=highlight><pre><span></span><code>show log event-handling handler &quot;auto-cert-update&quot;

===============================================================================
Event Handling System - Handlers
===============================================================================

===============================================================================
Handler          : auto-cert-update
===============================================================================
Description      : (Not Specified)
Admin State      : up                                Oper State : up

-------------------------------------------------------------------------------
Handler Execution Statistics
  Success        : 1
  Err No Entry   : 0
  Err Adm Status : 0
Total            : 1

-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Handler Action-List Entry
-------------------------------------------------------------------------------
Entry-id         : 10
Description      : (Not Specified)
Admin State      : up                                Oper State : up
Script
  Policy Name    : auto-cert-update
  Policy Owner   : TiMOS CLI
Min Delay        : 0
Last Exec        : 03/16/21 03:30:26 BST
-------------------------------------------------------------------------------
Handler Action-List Entry Execution Statistics
  Success        : 1
  Err Min Delay  : 0
  Err Launch     : 0
  Err Adm Status : 0
Total            : 1
===============================================================================
</code></pre></div> <h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">#</a></h2> <p>Handling of PKI infrastructure and TLS certificates is a complicated matter when a network of hundreds of nodes is concerned. An automated solution is needed to allow for certificate enrollment and lifecycle management.</p> <p>CMPv2 protocol is one of the protocols aimed to solve that task in a network infrastructure domain. Being extensively used in 4G and 5G networks, it is also applicable to nodes in the operators network. This lab demonstrated CMPv2 protocol operations and how it can be used to automatically enroll and renew certificates for an SR OS router using EJBCA server.</p> <p>The benefit of CMPv2 and protocols like it is in their ability to scale without increasing the operational effort. Once configured, the new nodes will come up with their templated configuration and will be able to request certificates and auto-renew them when time comes.</p> <div class=footnote> <hr> <ol> <li id=fn:1> <p>Resource requirements are provisional. Consult with the installation guides for additional information. Memory deduplication techniques like <a href=https://netdevops.me/2021/how-to-patch-ubuntu-20.04-focal-fossa-with-uksm/ >UKSM</a> might help with RAM consumption.&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p>The lab has been validated using these versions of the required tools/components. Using versions other than stated might lead to a non-operational setup process.&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> <li id=fn:3> <p>Router images are built with vrnetlab <a href=https://github.com/hellt/vrnetlab/tree/v0.2.3>v0.2.3</a>. To reproduce the image, checkout to this commit and build the relevant images. Note, that you might need to use containerlab of the version that is stated in the description.&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">&#8617;</a></p> </li> <li id=fn:4> <p><a href=https://github.com/openconfig/reference/blob/master/rpc/gnmi/gnmi-specification.md#31-session-security-authentication-and-rpc-authorization>https://github.com/openconfig/reference/blob/master/rpc/gnmi/gnmi-specification.md#31-session-security-authentication-and-rpc-authorization</a>&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">&#8617;</a></p> </li> <li id=fn:5> <p>The protocol is defined in RFC4210, RFC4211 and RFC4212, with further guidance in the transmission of CMP messages over HTTP being defined in RFC6712.&#160;<a class=footnote-backref href=#fnref:5 title="Jump back to footnote 5 in the text">&#8617;</a></p> </li> </ol> </div> <!-- Content footer --> <footer class="mdx-content__footer md-typeset"> <hr> <span class=twemoji> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M477.7 186.1 309.5 18.3c-3.1-3.1-8.2-3.1-11.3 0l-34 33.9c-3.1 3.1-3.1 8.2 0 11.3l11.2 11.1L33 316.5c-38.8 38.7-45.1 102-9.4 143.5 20.6 24 49.5 36 78.4 35.9 26.4 0 52.8-10 72.9-30.1l246.3-245.7 11.2 11.1c3.1 3.1 8.2 3.1 11.3 0l34-33.9c3.1-3 3.1-8.1 0-11.2zM318 256H161l148-147.7 78.5 78.3L318 256z"/></svg> </span> <hr> </footer> <script src=https://utteranc.es/client.js repo=hellt/clabs issue-term=pathname label=comment theme=preferred-color-scheme crossorigin=anonymous async>
    </script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> </a> </main> <!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Footer --> <footer class=md-footer> <!-- Link to previous and/or next page --> <nav class="md-footer__inner md-grid" aria-label=Footer> <!-- Link to previous page --> <a href=../security/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> About </div> </div> </a> <!-- Link to next page --> </nav> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <!-- Copyright and theme information --> <div class=md-footer-copyright> Made with <span class="twemoji heart"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0 16.709 16.709 0 0 1-.465-.252 31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513 1 5.052 3.829 2.5 6.736 2.5 9.03 2.5 10.881 3.726 12 5.605 13.12 3.726 14.97 2.5 17.264 2.5 20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z"/></svg> </span> by <a href=https://github.com/srl-labs/containerlab/graphs/contributors target=_blank rel=noopener> @hellt & contributors </a> </div> <!-- Social links --> <div class=md-footer-social> <a href=https://github.com/hellt target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/ntdvps target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.top", "navigation.instant", "navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script> <script src=../../assets/javascripts/bundle.d892486b.min.js></script> </body> </html>